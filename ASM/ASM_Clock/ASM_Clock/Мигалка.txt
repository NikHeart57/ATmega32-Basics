							; Подключение заголовочных файлов
.INCLUDE	"m32def.inc"		; Подключен заголовочный файл в котором хранятся адреса и символические имена.. 
								; ..регистров (типа: PORTA, DDRA, TIMSK и т.д.)
							; Присвоение символических имен				
.DEF		temp1 = r16			; Присвоение символического имени регистру r16 
.DEF		temp2 = r17			; Присвоение символического имени регистру r17
.DEF		temp3 = r18			; Присвоение символического имени регистру r18
								; *Для справки: у AtMega32 регистры общего назначения - r16-r25
.DSEG						; Прописываются ячейки оперативной памяти (стека) к которым будем обращатся. В данном случае их нет

.CSEG						; Начало програмного сегмента
.ORG		0x00				; Начальное значение для адресации. Указатель на вектор 0 - RESET. Данное прерываение вызывается при первом запуске или при триггере ножки RESET 

RESET:						; Начало кода вектора RESET
	LDI		temp1, Low(RAMEND)	; Инициализация стека - Обязательно!!!
	OUT		SPL,temp1			; Инициализация стека..
	LDI		temp1, High(RAMEND) ; Инициализация стека..
	OUT		SPH,temp1			; Инициализация стека
	SEI							; Разрешение прерываний
	LDI		temp1, 0xff			; Запись числа 0xff в регистр temp1 (r16)	*(1 - выход, 0 - вход)
	OUT		DDRC, temp1			; Отправка значения temp1 в регистр DDRC	*(реальный адрес $14)
	CLR		temp1				; Очистка регистра temp1


Start:						; Начало кода программы
	INC		temp1				; Инкремент регистра temp
	OUT		PORTC, temp1		; Перенос регистра в PORTC
	CALL	Delay				; Вызов подпрограммы задержки
	RJMP	Start				; Повтор Main

Delay:						; Код подпрограммы задержки
	push	temp1				; загрузка в стек
    LDI		temp1, 200			; загрузка константы для задержки в регистр temp1
DLoop1:
	LDI		temp2, 200
DLoop2:
    DEC		temp2				; уменьшаем значение в регистре temp2 на 1
    BRNE	DLoop2				; возврат к DLoop2 если значение в temp2 не равно 0 
	DEC		temp1				; уменьшаем значение в регистре temp1 на 1
    BRNE	DLoop1				; возврат к DLoop1 если значение в temp1 не равно 0 
	POP		temp1				; выгрузка из стека
	RET							; возврат из подпрограммы Delay

RJMP RESET