							; Подключение заголовочных файлов
.INCLUDE	"m32def.inc"		; Подключен заголовочный файл в котором хранятся адреса и символические имена регистров.. 
								; .. (типа: PORTA, DDRA, TIMSK и т.д.)
							; Присвоение символических имен				
.DEF		temp1 = r16			; Присвоение символического имени регистру r16 
.DEF		temp2 = r17			; Присвоение символического имени регистру r17
.DEF		temp3 = r18			; Присвоение символического имени регистру r18
								; *Для справки: у AtMega32 регистры общего назначения - r16-r25
.DSEG						; Прописываются ячейки оперативной памяти (стека) к которым будем обращатся. В данном случае их нет

.CSEG						; Начало програмного сегмента
.ORG		0x00				; Начальное значение для адресации. Указатель на вектор (Вектор номер - 1, адрес - $000, название - RESET, символическое имя - RESET)
								; Данное прерывание вызывается при первом запуске или при триггере ножки RESET 
RESET:						; Начало кода вектора RESET
	LDI		temp1,	Low(RAMEND)	; Инициализация стека - Обязательно!!!
	OUT		SPL,	temp1		; Инициализация стека..
	LDI		temp1,	High(RAMEND); Инициализация стека..
	OUT		SPH,	temp1		; Инициализация стека

	LDI		temp1,	0xff		; Запись числа 0xff в регистр temp1 (r16)	*(1 - выход, 0 - вход)
	OUT		DDRC,	temp1		; Отправка значения temp1 в регистр DDRC	*(реальный адрес $14)

	LDI		temp1,	(0 << FOC0) |(1  << WGM01)|(0 << WGM00)|(0 << COM01)|(0 << COM00)|(1 << CS02)|(0 << CS01)|(1 << CS00)
	OUT		TCCR0,	temp1
	LDI		temp1,	(1 << OCIE0)|(0 << TOIE0)
	OUT		TIMSK,	temp1
	LDI		temp1,	239
	OUT		OCR0,	temp1
	SEI							; Разрешение прерываний

	CLR		temp1				; Очистка регистра temp1

Start:						; Начало кода программы
	IN		temp1,	TIFR		; загрузка TIFR в регистр 16
	SBRS	temp1,	TOV0		; пропуск следующей инструкции, если установлен бит TOV0
	RJMP	Start				; Повтор Main

TIM0_COMP:					; Код вектора прерываний (Вектор номер - 11, адрес - $014, название - TIMER0 COMP, символическое имя - TIM0_COMP)
	CLI	
	PUSH	temp1   
	IN		temp1,SREG
	PUSH	temp1
	IN		temp1, PORTC		; Пересылка из I/O-регистра в регистр
	INC		temp1
	OUT		PORTC,	temp1		; Пересылка из регистра в I/O-регистр
	POP		temp1
	OUT		SREG,	temp1
	POP		temp1
	RETI

RJMP 0x00